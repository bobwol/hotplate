var dummy
, hotplate =  require('hotplate')
, path = require('path')
, passport = require('passport')
;

exports.hotHooks = hooks = {}

var app = hotplate.app;

hooks.run = function( done ){
  app.use(passport.initialize());
  app.use(passport.session());

  done( null );

}


// Simply activate path to client files
hooks.clientPaths = function( done ){
  done( null, { moduleName: 'hotPassport', result: [ path.join(__dirname, '../client') ] } );
}

hooks.run = function( done ){

  logger = hotplate.getModule('hotServerLogger');
  var e = hotplate.getModule('hotError').errors;
  var hotPage = hotplate.getModule('hotPage');


  app.get('/passport' , function(req, res, next){
    extraJses = (new hotPage.Jses).add('hotDojoAuth', 'passport.js');
    extraCsses = (new hotPage.Csses).add('hotDojoAuth', 'rrl.css');
    result = hotPage.processPageTemplate( { jses:extraJses, csses:extraCsses, body: '<body class="claro"><div id="loginForm"></div></body>' } );
    res.send( result );
    logger.log( { message: "Login page served" } );
  });

  done( null );

}


