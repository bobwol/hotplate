

define([
   "dojo/_base/declare",
   "../buttons/_Button",
   "../buttons/_ManagerButton",
   ], function(
     declare
     , _Button
     , _ManagerButton
 ){

  var ret = {};


  var SignInRecoverRegister = declare( [ _Button ], {
    strategyId: 'facebook',
    action: 'signin',

    postCreate: function(){
      var self = this;

      this.inherited( arguments );

      var action = self.action;
      if( action !== 'signin' && action !== 'recover' && action !== 'register' ){
        action = 'signin';
      }

      this.button.on('click', function( e ){
        window.open('/auth/' + self.action + '/facebook', '', 'width=800, height=600');
      });
    },
  });

  ret.SignIn = declare( [ SignInRecoverRegister ], {
    action: 'signin'
  });

  ret.Recover = declare( [ SignInRecoverRegister ], {
    action: 'recover'
  });

  ret.Register = declare( [ SignInRecoverRegister ], {
    action: 'register'
  });


  ret.Manager = declare( [ _ManagerButton ], {

    strategyId: 'facebook',

    postCreate: function(){
      this.inherited( arguments );

      var self = this;

      self.button.on('click', function( e ){
        if( ! self.strategyData ){
          window.open('/auth/manager/facebook', '', 'width=800, height=600');
        } else {
          self._deleteStrategyData( "Delete credentials?", "Are you sure you want to unlink your Facebook account?" );
        }
      });

    },

  });

  return ret;
});





